\section{√övod do matematick√© optimalisace}

\subsection{D≈Økaz souvislosti minima a maxima}
Tvrzen√≠. Pro $f: D \rightarrow \R, M \subseteq D, \hat{x} \in M$ plat√≠:

\begin{enumerate}[(1)]
    \item $\hat{x} \in \underset{x \in M}{\argmin} f(x) \iff \hat{x} \in \underset{x \in M}{\argmax} (-f(x))$,
    \item jesli≈æe $\hat{x} \in \underset{x \in M}{\argmin} f(x)$, pak $\underset{x \in M}{\min} f(x) =
    - \underset{x \in M}{\max} (-f(x))$.
\end{enumerate}
D≈Økaz.
\begin{enumerate}[(1)]
    \item $\hat{x} \in \underset{x \in M}{\argmin} f(x)$, tj. $f(\hat{x}) \leq f(x), 
    \forall x \in M \underset{\cdot (-1)}{\iff}
    -f(\hat{x}) \geq -f(x), \forall x \in M$,\\tj. $\hat{x} \in \underset{x \in M}{\argmax} (-f(x)). \qed$

    \item A≈• $\hat{x} \in \underset{x \in M}{\argmin} f(x)$, pak $\underset{x \in M}{\min} f(x) = f(\hat{x}) =
    - (- f(\hat{x})) \overset{(1)}{=} - \underset{x \in M}{\max} (-f(x)). \qed$
\end{enumerate}

\subsection{Hled√°n√≠ p≈ô√≠pustn√Ωch mno≈æin}
\optAs{min}{x^2 + 1}{
    \frac{3}{x} &\leq 1, \\
    x &\in \N.}
Uprav√≠me podm√≠nky a udƒõl√°me jejich pr≈Ønik: $(x - 3 \geq 0) \land (x \in \N) \Rightarrow M = \N \setminus \bc{1,2}$.

√övahou pak lze uhodnout minimum - minimum le≈æ√≠ v bodƒõ $x=3$.

\subsection{Hled√°n√≠ p≈ô√≠pustn√Ωch mno≈æin}
\optAs{max}{\ln x}{%
    \cos(\pi x) &= 1,\\
    x &\leq 5.
}
$D(f) = (0, \infty)$.

Udƒõlejme pr≈Ønik definiƒçn√≠ho oboru funkce a podm√≠nek: $(x \in (0, \infty)) \land (x \leq 5) \land (\cos(\pi x)=1)$.

\begin{multicols}{2}
  \begin{figure}[H]
    \center
    \begin{tikzpicture}[scale=0.8]
      \begin{axis}[
        axis lines = middle,
        xlabel = $x$,
        ylabel = {$\cos(\pi x)$},
        domain=0:5,
        samples=1000,
        %   xtick={0,1,2,3,4,5},
        %   ytick={-1,-0.5,0,0.5,1},
        enlargelimits,
        grid=both,
        minor grid style={dotted},
        major grid style={dashed},
        width=10cm, height=6cm,
        ]
        \addplot[blue, thick] {cos(deg(x * pi))};
        \addplot[only marks, red, mark=*] coordinates {(2,1) (4,1)};
      \end{axis}
    \end{tikzpicture}
  \end{figure}
\columnbreak
      Oƒçividnƒõ tedy $M = \bc{2,4}$.\\
      √övahou pak lze uhodnout $\underset{x \in M}{\argmax} \ln x = \bc{4}$.
\end{multicols}

\subsection{Maximalisaƒçn√≠ √∫loha}
Banka nab√≠z√≠ dva investiƒçn√≠ produkty. Oƒçek√°van√Ω mƒõs√≠ƒçn√≠ v√Ωnos prvn√≠ho investiƒçn√≠ho produktu (v tis. Kƒç) p≈ôi investici 
$x$ (v tis. Kƒç) je $\frac{2x}{4x+25}$ a oƒçek√°van√Ω mƒõs√≠ƒçn√≠ v√Ωnos druh√©ho invetiƒçn√≠ho produktu (v tis. Kƒç) p≈ôi investici 
$x$ (v tis. Kƒç) je $\frac{x}{x+50}$. Jak√Ωm zp≈Øsobem m√° investor rozdƒõlit ƒç√°stku $c = 100000$ Kƒç mezi uveden√© dva 
produkty tak, aby celkov√Ω oƒçek√°van√Ω mƒõs√≠ƒçn√≠ v√Ωnos byl co nejvƒõt≈°√≠?
\optAs{max}{\frac{x}{x+50} + \frac{2y}{4y + 25}}{%
    x+y &= 100,\\
    x,y &\geq 0.
}
Vyj√°d≈ôeme si jednu promƒõnnou v z√°vislosti na druh√©, nap≈ô√≠klad $x = 100 - y$. N√°slednƒõ dosad√≠me do √∫lohy a vy≈°et≈ô√≠me
stacion√°rn√≠ body pomoc√≠ prvn√≠ derivace.
\[
    \frac{\dif}{\dif y} \left(\frac{100-y}{150-y} + \frac{2y}{4y + 25}\right)= \frac{-50}{(150-y)^2} + \frac{50}{(4y + 25)^2}
    \stackrel{!}{=}0
\]
Zbavme se zlomk≈Ø:
\begin{align*}
    -50(4y + 25)^2 + 50(150-y)^2 &= 0 \\
    (150-y)^2 - (4y + 25)^2 &= 0 \\
    (150-y -4y - 25) - (150-y + 4y + 25) &=0\\
    (125 - 5y) (175 + 3y) &=0 \\
    y_1 = 25, y_2 \approx -58.3
\end{align*}
Tedy aby byly splnƒõny v≈°echny podm√≠nky je jedin√© mo≈æn√© ≈ôe≈°en√≠ $y = 25 \rightarrow x = 75$.

\subsection{Minimalisaƒçn√≠ √∫loha}
Ve firmƒõ pot≈ôebuj√≠ nal√©zt rozmƒõry otev≈ôen√© krabice (tj. krabice bez horn√≠ stƒõny) se ƒçtvercovou podstavou o objemu $10$
d$\text{m}^3$ tak, aby obsah plochy jej√≠ho pl√°≈°tƒõ byl co nejmen≈°√≠. Formulujte odpov√≠daj√≠c√≠ optimalisaƒçn√≠ √∫lohu za
p≈ôedpokladu, ≈æe krabice je vyrobena z materi√°lu, jeho≈æ tlou≈°≈•ka je zanedbateln√°. Tuto √∫lohu pot√© vy≈ôe≈°te.

\begin{center}
    \begin{tikzpicture}
        \draw[dashed] (1,1) -- (1,3);
        \draw[dashed] (1,1) -- (4,1);
        \draw[dashed] (1,1) -- (0,0);

        \draw[thick] (0,0) rectangle (3,2);
        \draw[thick] (3,2) -- (4,3) -- (1,3) -- (0,2);
        \draw[thick] (4,3) -- (4,1) -- (3,0);
        \draw[thick] (0,2) -- (0,0);

        \node at (1.5,-0.3) {\(x\)};
        \node at (-0.3,1) {\(y\)};
        \node at (3.7,0.4) {\(x\)};
    \end{tikzpicture}
\end{center}
\optAs{min}{4xy + x^2}{%
    x^2 y &= 10, \\
    x,y &> 0.
}
Vyj√°d≈ôeme si jednu promƒõnnou v z√°vislosti na druh√©, nap≈ô√≠klad $y = \frac{10}{x^2}$. N√°slednƒõ dosad√≠me do √∫lohy a vy≈°et≈ô√≠me
stacion√°rn√≠ body pomoc√≠ prvn√≠ derivace.
\[
    \frac{\dif}{\dif y} \left(4x \frac{10}{x^2} + x^2\right)= \frac{-40}{x^2} + 2x \stackrel{!}{=} 0
\]
Zbavme se zlomk≈Ø:
\begin{align*}
    -40 + 2x^3 &= 0 \\
    x^3 &= 20  \\
    x &= \sqrt[3]{20}
\end{align*}
Tedy jedin√© mo≈æn√© ≈ôe≈°en√≠ $x = \sqrt[3]{20} \rightarrow y = \frac{10}{\left(\sqrt[3]{20}\right)^2} =  \sqrt[3]{\frac{5}{2}}$.

% \subsection{Maximalisaƒçn√≠ √∫loha}
% V tov√°rnƒõ vyr√°bƒõj√≠ zbo≈æ√≠ r≈Øzn√Ωch druh≈Ø. Oznaƒçme je $X_1, \dots, X_n$. Na jejich v√Ωrobu pot≈ôebuj√≠ materi√°ly $Y_1, \dots, Y_m$.
% Na skladƒõ maj√≠ k dispozici mno≈æstv√≠ $b_i$ materi√°lu $Y_i$ a na trhu ho nakupuj√≠ za cenu $\gamma_i$. Na v√Ωrobu jednotkov√©ho
% mno≈æstv√≠ zbo≈æ√≠ $X_j$ pot≈ôebuj√≠ mno≈æstv√≠ $a_{ij}$ materi√°lu $Y_i$. Jednotkov√© mno≈æstv√≠ v√Ωrobku $X_j$ prod√°vaj√≠ za cenu
% $\sigma_j$. Formulujte optimalisaƒçn√≠ √∫lohu probl√©mu nastaven√≠ mno≈æstv√≠ v√Ωroby jednotliv√Ωch druh≈Ø produkt≈Ø (p≈ôedpokl√°dejte,
% ≈æe hledan√° mno≈æstv√≠ nemus√≠ b√Ωt celoƒç√≠seln√°) tak, aby celkov√Ω zisk z jejich prodeje byl co nejvƒõt≈°√≠.
%
\subsection{Optimalisaƒçn√≠ √∫loha s nadrovinami}
V $\R^n$ jsou d√°ny mno≈æiny bod≈Ø $A = \bc{a_1, \dots, a_k}$ a $B = \bc{b_1, \dots, b_t}$. A≈• $w \in \R^n$ a $\lambda \in \R$.
P≈ôedpokl√°dejme, ≈æe $H$ je nadrovina o rovnici $\langle x,w \rangle + \lambda = 0$, $H_1$ je nadrovina o rovnici
$\langle x, w \rangle + \lambda = 1$ a $H_2$ je nadrovina o rovnici $\langle x, w \rangle + \lambda = -1$.
\begin{enumerate}[(a)]
    \item Uka≈æte, ≈æe vzd√°lenost mezi nadrovinami $H_1$ a $H_2$ je $\frac{2}{||w||}$. D√°le uka≈æte, ≈æe $\frac{1}{||w||}$
    je vzd√°lenost $H$ od $H_1$ a tak√© vzd√°lenost $H$ od $H_2$.
    \item Iterpretujte optimalisaƒçn√≠ √∫lohu
    \optAs{max}{g(w, \lambda) = \frac{2}{||w||}}{%
        &\langle a_i, w \rangle + \lambda \geq 1 &\text{pro v≈°echna } i=1, \dots, k, \\
        &\langle b_i, w \rangle + \lambda \leq -1 &\text{pro v≈°echna } j=1, \dots, l.
    }
    \item Uka≈æte, ≈æe $(\hat w,\hat \lambda)$ je ≈ôe≈°en√≠m √∫lohy z p≈ôedchoz√≠ho bodu pr√°vƒõ tehdy, kdy≈æ je ≈ôe≈°en√≠m √∫lohy
    (kvadratick√©ho programov√°n√≠) ve tvaru
    \optAs{min}{h(w, \lambda) = \frac{1}{2} ||w||^2}{%
        &\langle a_i, w \rangle + \lambda \geq 1 &\text{ pro v≈°echna } i=1, \dots, k, \\
        &\langle b_i, w \rangle + \lambda \leq -1 &\text{ pro v≈°echna } j=1, \dots, l.
    }
\end{enumerate}

(a) 

\begin{multicols}{2}
  \begin{figure}[H]
    \center
    \begin{tikzpicture}[scale=0.8]
        \draw[->] (-3,0) -- (6,0) node[right] {$x$};
        \draw[->] (0,-2) -- (0,5) node[above] {$y$};
      
        \draw[thick,blue] (-2,0) -- (5,3.5) node[right, sloped] {$H$}; % midway
      
        \draw[dashed,red] (-2.22,0.45) -- (4.78,3.95) node[above, sloped] {$H_2$};
        \draw[dashed,red] (-1.78,-0.45) -- (5.22,3.05) node[below, sloped] {$H_1$};
      
        \filldraw[black] (0.5,0.5) circle (2pt) node[below right] {$a_1$};
        \filldraw[black] (2,0.7) circle (2pt) node[below right] {$a_2$};
        \filldraw[black] (3,1.4) circle (2pt) node[below right] {$a_3$};
      
        \filldraw[black] (0.2,3) circle (2pt) node[above right] {$b_1$};
        \filldraw[black] (1.7,3) circle (2pt) node[above] {$b_2$};
        \filldraw[black] (3,3.5) circle (2pt) node[above right] {$b_3$};
    
        \draw[thick,green!70!black] (-2,4) -- (1,-2) node[below, sloped] {$\pi$};
        \filldraw[black] (-0.18,0.35) circle (2pt) node[left] {$P$};
        \filldraw[black] (-0.62,1.25) circle (2pt) node[above right] {$Q$};
    
        \filldraw[black] (0,0) circle(0pt) node[below left] {\tiny 0};
    \end{tikzpicture}
  \end{figure}

\columnbreak

    $\pi : x = t \cdot w, t \in \R$.

    Pr≈Øseƒç√≠k $Q$:

    $\underbrace{\langle tw, w\rangle}_{t ||w||^2} + \lambda = 1$ $\rightarrow t = \frac{1-\lambda}{||w||^2}$
    $\Rightarrow Q = \frac{1-\lambda}{||w||^2} w$

    Pr≈Øseƒç√≠k $P$:

    $\underbrace{\langle tw, w\rangle}_{t ||w||^2} + \lambda = -1$ $\rightarrow t = \frac{-1-\lambda}{||w||^2}$
    $\Rightarrow P = \frac{-1-\lambda}{||w||^2} w$
\end{multicols}

Pak vzd√°lenost mezi nadrovinami $H_1$ a $H_2$ je d√°na rozd√≠lem pr≈Øseƒç√≠k≈Ø $P$ a $Q$ v normƒõ. Tedy:
\[
    || Q - P || = \left\| \frac{1-\lambda}{||w||^2} w  + \frac{1 + \lambda}{||w||^2} w\right\| = 
    \left\| \frac{2w}{||w||^2} \right\| = \frac{2}{||w||^2} ||w|| = \frac{2}{||w||} \text{.}
\]
To je pr√≠ma, to jsme p≈ôesnƒõ chtƒõli. $\qed$

(b) % TODO: dodƒõlat

(c) V √∫loze (b) maximalisujeme zlomek, kde se promƒõnn√° nach√°z√≠ ve jmenovateli. Tedy sna≈æ√≠me se naj√≠t co nejmen≈°√≠ mo≈æn√Ω
jmenovatel, aby zlomek mƒõl co nejvƒõt≈°√≠ hodnotu. M≈Ø≈æeme √∫lohu p≈ôevr√°tit a minimalisovat samotn√Ω jmenovatel. Proto≈æe
n√°soben√≠ je line√°rn√≠ a zachov√°v√° n√°m v≈°echny nerovnosti, m≈Ø≈æeme r≈Øznƒõ modifikovat jakou konstantou n√°sob√≠me n√°mi
minimalisovanou promƒõnnou. Z√°rove≈à si m≈Ø≈æeme dovolit umocnit normu, proto≈æe i to n√°m zachov√° v≈°echny nerovnosti. Zde si 
tedy chyt≈ôe zvol√≠me n√°soben√≠ $\frac{1}{2}$, proto≈æe p≈ôi n√°sledn√©m hled√°n√≠ stacion√°rn√≠ch bod≈Ø funkce n√°m vyskoƒç√≠ z kvadr√°tu 
dvojka, jen≈æ pƒõknƒõ pokr√°t√≠me. Podm√≠nky n√°m z≈Østaly stejn√©, nen√≠ co ≈ôe≈°it.

% \subsection{Optimalisaƒçn√≠ √∫loha se spojnicemi bod≈Ø}
% V rovinƒõ jsou d√°ny body $P = (0,0)^T$ a $Q = (1,1)^T$.
% \begin{enumerate}[(a)]
%     \item Formulujte optimalisaƒçn√≠ √∫lohu probl√©mu nalezen√≠ nejkrat≈°√≠ spojnice bod≈Ø $P$ a $Q$. Spojnic√≠ rozum√≠me k≈ôivku
%     danou grafem spojitƒõ diferencovateln√© funkce $f : [0,1] \rightarrow \R$.
%     \item Naleznƒõte ≈ôe≈°en√≠ √∫lohy z p≈ôedchoz√≠ho bodu.\footnote{N√°povƒõda: Uka≈æte, ≈æe $g(t) = t, t \in [0,1]$, je ≈ôe≈°en√≠m
%     √∫lohy. Vyu≈æijte p≈ôitom toho, ≈æe pro dvƒõ spojit√© funkce $f_1$ a $f_2$ na intervalu $[0,1]$ je $\int_0^1 \left(f_1(t),
%     f_2(t) \right)^T \dif T loneq \left(\int_0^1 f_1 (t) \dif t, \int_a^b f_2 (t) \dif t \right)^T$ a plat√≠ \\
%     $\left| \left| \int_0^1 (f_1 (t), f_2 (t))^T \dif t \right| \right| \leq \int_0^1 \left| \left| (f_1 (t), f_2 (t))^T \right| \right| \dif t$.
%     K d≈Økazu jednoznaƒçnosti pak lze vyu≈æ√≠t tvrzen√≠, ≈æe rovnost v uveden√© \uv{troj√∫heln√≠kov√© nerovnosti pro integr√°ly}
%     nast√°v√° p√°vƒõ tehdy, kdy≈æ existuje spojit√° funkce $\lambda : [0,1] \rightarrow \R$ takov√°, ≈æe $(f_1 (t), f_2 (t))^T =
%     \lambda (t) \int_0^1 (f_1 (t), f_2 (t))^T \dif t$.
%     }
% \end{enumerate}

% \subsection{Optimalisaƒçn√≠ √∫loha s √∫seƒçkami}
% V rovinƒõ jsou d√°ny body $P = (-1, 0)^T$ a $Q = (1,0)^T$. A≈• $L$ je √∫seƒçka s krajn√≠mi body $P$ a $Q$.
% \begin{enumerate} [(a)]
%     \item Formulujte optimalisaƒçn√≠ plohu probl√©mu nalezen√≠ spojitƒõ diferencovateln√© funkce $y : [-1, 1] \rightarrow \R$,
%     jej√≠≈æ graf m√° koncov√© body $P$ a $Q$, d√©lku $l=3$, le≈æ√≠ v horn√≠ polorovinƒõ a spolu s √∫seƒçkou $L$ ohraniƒçuje ƒç√°st
%     roviny o nejvƒõt≈°√≠m obsahu.
%     \item A≈• $(x_0, x_1, \dots, x_k)$ je ekvidistantn√≠ dƒõlen√≠ intervalu $[-1, 1]$ (tj. $x_l = l \delta$, kde
%     $\delta = \frac{2}{k}$). Vyu≈æit√≠m tohoto dƒõlen√≠ k aproximaci integr√°lu pomoc√≠ koneƒçn√© sumy a derivace pomoc√≠ diferenc√≠
%     naleznƒõte optimalisaƒçn√≠ √∫lohu v $\R^{k+1}$, jej√≠≈æ ≈ôe≈°en√≠ aproximuje ≈ôe≈°en√≠ √∫lohy z p≈ôedchoz√≠ho bodu.
% \end{enumerate}

% \subsection{Vztah argmin}
% A≈• $\varphi : X \rightarrow Y$ je bijekce, $D_f \subseteq X, D_g \subseteq Y, \varphi(D_f) \subseteq D_g, M \subseteq D_f$
% a $\hat x \in M$. P≈ôedpokl√°dejme, ≈æe funkce $f : D_f \rightarrow \R$ a $g : D_g \rightarrow \R$ spl≈àuj√≠ $f = g \circ \varphi$.
% Uka≈æte, ≈æe $\hat x \in \argmin_{x \in M} f(x)$ pr√°vƒõ tehdy, kdy≈æ $\varphi (\hat x) \in \argmin_{y \in \varphi (M)} g(y)$.
